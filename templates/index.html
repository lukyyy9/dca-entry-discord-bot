{% extends "base.html" %}

{% block content %}
<h1 style="margin-bottom: 20px;">üìä Dashboard</h1>

<div class="grid">
    <div class="card">
        <h2>‚öôÔ∏è Configuration actuelle</h2>
        <p><strong>Mode Dev:</strong> {{ '‚úÖ Activ√©' if config.dev_mode else '‚ùå D√©sactiv√©' }}</p>
        <p><strong>P√©riode de donn√©es:</strong> {{ config.data_period }}</p>
        <p><strong>Timezone:</strong> {{ config.timezone }}</p>
        <p><strong>Tickers surveill√©s:</strong> {{ config.tickers|length }}</p>
    </div>
    
    <div class="card">
        <h2>üìà Poids des composants</h2>
        <p><strong>Drawdown:</strong> {{ (config.weights.drawdown90 * 100)|round(1) }}%</p>
        <p><strong>RSI:</strong> {{ (config.weights.rsi14 * 100)|round(1) }}%</p>
        <p><strong>MA50:</strong> {{ (config.weights.dist_ma50 * 100)|round(1) }}%</p>
        <p><strong>Momentum:</strong> {{ (config.weights.momentum30 * 100)|round(1) }}%</p>
        <p><strong>Trend MA200:</strong> {{ (config.weights.trend_ma200 * 100)|round(1) }}%</p>
        <p><strong>Volatilit√©:</strong> {{ (config.weights.volatility20 * 100)|round(1) }}%</p>
    </div>
</div>

<div class="card">
    <h2>üìú Historique r√©cent</h2>
    {% if history %}
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Ticker</th>
                <th>Score</th>
                <th>Prix</th>
                <th>RSI</th>
                <th>MA50</th>
                <th>MA200</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in history %}
            <tr>
                <td>{{ entry.timestamp[:10] }}</td>
                <td><strong>{{ entry.ticker }}</strong></td>
                <td>
                    <span class="{% if entry.score >= 55 %}score-good{% elif entry.score >= 45 %}score-warning{% else %}score-bad{% endif %}">
                        {{ entry.score }}
                    </span>
                </td>
                <td>{{ entry.close|round(2) }}</td>
                <td>{{ entry.rsi14 }}</td>
                <td>{{ entry.ma50|round(2) if entry.ma50 else 'N/A' }}</td>
                <td>{{ entry.ma200|round(2) if entry.ma200 else 'N/A' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="color: #8b949e;">Aucun historique disponible</p>
    {% endif %}
</div>
{% endblock %}
